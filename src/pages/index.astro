---
// ============================================================================
// IMPORTS
// ============================================================================
import BaseLayout from "../layouts/BaseLayout.astro";
import ArcCanvas from "../components/ArcCanvas.astro";
import SiteHeader from "../components/SiteHeader.astro";
import PageNavigation from "../components/PageNavigation.astro";
import Card from "../components/Card.astro";
import LinkButton from "../components/LinkButton.astro";
import '../styles/pages/home.css';

import { withBase } from '../utils/paths';
import { buildSEO } from '../utils/seo';
import { EXTERNAL_LINKS } from '../config/constants';

// ============================================================================
// SEO
// ============================================================================
const seo = buildSEO({
  title: "arc^",
  description: "arc^ is an open research framework building plasma technology for ecological repair. We work openly, share everything, and build technology that serves life over profit.",
  path: "/",
  siteUrl: Astro.site,
});
---

<BaseLayout 
  title={seo.title}
  description={seo.description} 
  bodyClass="page-home" 
  seo={seo}
>
  <ArcCanvas />
  <SiteHeader active="home" />
  
  <main id="main-content" class="page-shell" aria-labelledby="main-title">
    
    <!-- ========================================================================
         SECTION 1: THE WHAT (Functional/Scientific)
         ======================================================================== -->
    <header class="home-hero" aria-labelledby="main-title">
      <p class="eyebrow">Building Technology for a Better Future</p>
      <h1 id="main-title">arc^</h1>
      <p class="lead home-lede">
        arc^ is an <em>open research framework</em> building plasma technology for ecological repair. 
        We bring together <em>researchers, builders, and communities</em> to develop technology that 
        serves <em>life over profit</em>. If you're ready to work openly and collaboratively, there's 
        a place for you here.
      </p>
      
      <!-- Action buttons for immediate engagement -->
      <div class="hero-actions">
        <LinkButton 
          href={withBase("/projects")} 
          variant="primary"
          icon="arrow-right"
        >
          Explore Project Ideas
        </LinkButton>
        <LinkButton 
          href={withBase("/how")} 
          variant="outline"
          icon="arrow-right"
        >
          See How We Work
        </LinkButton>
      </div>
    </header>

    <!-- ========================================================================
         SECTION 2: THE WHY (Emotional/Purposeful)
         ======================================================================== -->
    <Card as="section" class="why-section" padding="spacious">
      <div class="why-content">
        <p class="eyebrow">For Our Land. For Our People. For Collective Futures.</p>
        
        <p class="why-lede">
          This work is for those who refuse extraction and choose regeneration. Technology should serve 
          <em>the many, not the few</em>—building <em>futures worth inheriting</em> for our 
          communities, our land, our shared survival. If you believe another world is possible, you're already 
          part of this.
        </p>

        <div class="why-action">
          <LinkButton 
            href={withBase("/about")} 
            variant="outline"
            icon="arrow-right"
          >
            Meet the Person Behind arc^
          </LinkButton>
        </div>
      </div>
    </Card>

    <!-- ========================================================================
         SECTION 3: ETYMOLOGY (Cultural Context + Mathematical Symbolism)
         ======================================================================== -->
    <section class="etymology-callout" aria-labelledby="etymology-heading">
      <div class="etymology-content">
        <h2 id="etymology-heading" class="visually-hidden">Origin of arc^</h2>
        
        <!-- Context intro -->
        <p class="etymology-context">The name <em>arc^</em> holds dual meaning:</p>
        
        <!-- Pronunciation block -->
        <div class="pronunciation-block">
          <div class="pronunciation-title">
            <span class="arc-text">arc<sup>^</sup></span>
            <span class="pronunciation-text">/ark-up/</span>
          </div>
          <button class="audio-button" aria-label="Play pronunciation of arc up" type="button">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
            <span class="button-text">Listen</span>
          </button>
        </div>
        
        <!-- Definitions -->
        <div class="etymology-definitions">
          <p class="etymology-definition">
            <strong>"to arc up"</strong> <em>(Australian slang)</em><br>
            to rise in defense of people and planet
          </p>
          
          <p class="etymology-definition">
            <strong>"^"</strong> <em>(mathematical notation)</em><br>
            to the power of — amplifying change through the scientific method
          </p>
        </div>
      </div>
    </section>

    <!-- ========================================================================
         SECTION 4: NAVIGATION CARDS (How to Engage)
         ======================================================================== -->
    <nav class="home-nav-cards" aria-label="Main site sections">
      
      <!-- Projects Card -->
      <a href={withBase("/projects")} class="nav-card">
        <h3>Projects</h3>
        <p>Explore open plasma research and ecological applications</p>
        <span class="nav-card-arrow" aria-hidden="true">→</span>
      </a>
      
      <!-- Method Card -->
      <a href={withBase("/how")} class="nav-card">
        <h3>Method</h3>
        <p>Learn how we work: openly, ethically, regeneratively</p>
        <span class="nav-card-arrow" aria-hidden="true">→</span>
      </a>
      
      <!-- Join Card -->
      <a href={withBase("/join")} class="nav-card">
        <h3>Join</h3>
        <p>Contribute to research building technology for life</p>
        <span class="nav-card-arrow" aria-hidden="true">→</span>
      </a>

      <!-- Beyond arc^ Card (External) -->
      <a 
        href={EXTERNAL_LINKS.personalSite} 
        target="_blank" 
        rel="noopener noreferrer" 
        class="nav-card nav-card--external"
      >
        <h3>Beyond arc^</h3>
        <p>Explore writing, philosophy, and projects outside this framework</p>
        <span class="nav-card-arrow" aria-hidden="true">↗</span>
      </a>
      
    </nav>

  </main>

  <PageNavigation currentPage="home" />

  <!-- ========================================================================
       AUDIO PRONUNCIATION SCRIPT
       ======================================================================== -->
  <script>
    const btn = document.querySelector('.audio-button');
    if (btn) {
      btn.addEventListener('click', () => {
        const base = import.meta.env.BASE_URL || '/';
        const audioPath = `${base}audio/EN-AU_ck1_arc_up.mp3`.replace('//', '/');
        const audio = new Audio(audioPath);
        
        audio.play().catch(err => {
          console.error('Audio playback failed:', err);
          // Fallback to speech synthesis
          if ('speechSynthesis' in window) {
            const utterance = new SpeechSynthesisUtterance('arc up');
            utterance.rate = 0.8;
            utterance.pitch = 1;
            window.speechSynthesis.speak(utterance);
          }
        });
      });
    }
  </script>

</BaseLayout>